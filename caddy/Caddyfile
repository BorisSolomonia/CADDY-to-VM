:80 {
  log {
    output stdout
    format console
    level INFO
  }

  encode gzip zstd

  # Simple health for Caddy itself
  @health path /health
  respond @health "OK" 200

  # ERP API -> container port 3005
  handle_path /api/* {
    reverse_proxy http://nine-tones-app:3005
  }

  # ERP UI -> container port 3004 (catch-all)
  handle {
    reverse_proxy http://nine-tones-app:3004
  }

  header {
    -Server
    X-Content-Type-Options nosniff
    X-Frame-Options DENY
    Referrer-Policy "strict-origin-when-cross-origin"
  }
}
