:80 {
    log {
      output stdout
      format console
      level DEBUG
    }

    encode gzip zstd

    @health path /health
    respond @health "OK" 200

    # Use IP address instead of hostname to fix DNS resolution
    handle_path /api/* {
      reverse_proxy http://172.18.0.5:3005
    }

    handle {
      reverse_proxy http://172.18.0.5:3004
    }

    header {
      -Server
      X-Content-Type-Options nosniff
      X-Frame-Options DENY
      Referrer-Policy "strict-origin-when-cross-origin"
    }
  }